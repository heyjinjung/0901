# Casino-Club F2P 운영 환경 필수 설정값

## 🚨 즉시 수정 필요 (지금 당장 문제되는 4개)

### 1. JWT_SECRET_KEY (로그인 토큰 암호화)
```bash
JWT_SECRET_KEY=YOUR_64_CHAR_RANDOM_SECRET
JWT_SECRET=YOUR_64_CHAR_RANDOM_SECRET
```
- **현재 상태**: `super_secure_production_key_here` (템플릿 값)
- **문제**: 로그인 실패, 토큰 검증 오류
- **해결**: 64자 이상 랜덤 문자열로 교체

### 2. POSTGRES_PASSWORD (데이터베이스 접속)
```bash
POSTGRES_PASSWORD=YOUR_STRONG_DB_PASSWORD
POSTGRES_USER=casino_admin
```
- **현재 상태**: `secure_password_here` (템플릿 값)
- **문제**: 데이터베이스 연결 실패, 모든 데이터 읽기/쓰기 불가
- **해결**: 실제 DB 비밀번호로 교체

### 3. REDIS_PASSWORD (캐시/세션 관리)
```bash
REDIS_PASSWORD=YOUR_REDIS_PASSWORD
```
- **현재 상태**: `change_this_for_prod` (템플릿 값)
- **문제**: 실시간 데이터 동기화 실패, 세션 저장 불가
- **해결**: 실제 Redis 비밀번호로 교체

### 4. 도메인 URL (CORS/API 호출)
```bash
FRONTEND_URL=https://your-domain.com
BACKEND_URL=https://api.your-domain.com
```
- **현재 상태**: 템플릿 도메인
- **문제**: CORS 오류, 외부 접속 불가
- **해결**: 실제 도메인으로 교체

---

## 🔧 추가 운영 설정 (단계적 적용)

### 결제/상점 시스템 (현재 사용 안 함)
```bash
# 비활성화 방침: 결제 게이트웨이 미사용
# 아래 값들은 설정하지 않거나, 기능 플래그가 있다면 0으로 둡니다.
# PAYMENTS_ENABLED=0
# PAYMENT_SECRET_KEY=
# PAYMENT_CLIENT_ID=
# PAYMENT_WEBHOOK_SECRET=
SHOP_CURRENCY_RATE=1000
MAX_PURCHASE_AMOUNT=1000000
```

### 메시지 큐/실시간 통신
```bash
KAFKA_BOOTSTRAP_SERVERS=kafka1.server.com:9092
KAFKA_SECURITY_PROTOCOL=SASL_SSL
KAFKA_SASL_USERNAME=YOUR_KAFKA_USER
KAFKA_SASL_PASSWORD=YOUR_KAFKA_PASSWORD
WEBSOCKET_SECRET=YOUR_WEBSOCKET_SECRET
```

### 외부 서비스 연동
```bash
# 이메일 발송 (현재 사용 안 함)
# EMAIL_ENABLED=0
# EMAIL_API_KEY=
# EMAIL_FROM=

# SMS 발송 (현재 사용 안 함)
# SMS_ENABLED=0
# SMS_API_KEY=
# SMS_SECRET_KEY=

# 푸시 알림 (기본: Firebase 미사용)
# 기본 정책은 Firebase/FCM 미사용입니다. Web Push(VAPID) 또는 완전 비활성 중 선택하세요.
# PUSH_ENABLED=0                      # 완전 비활성 시 사용
# VAPID_PUBLIC_KEY=YOUR_VAPID_PUBLIC  # VAPID 사용 시(백엔드가 지원하는 경우)
# VAPID_PRIVATE_KEY=YOUR_VAPID_PRIVATE

# FCM은 사용하지 않습니다. 값은 비워두세요(미설정).
# FCM_SERVER_KEY=
# FCM_PROJECT_ID=
```

### 모니터링/로깅
```bash
# 에러 추적 (Sentry)
SENTRY_DSN=https://YOUR_SENTRY_DSN@sentry.io/PROJECT_ID
SENTRY_ENVIRONMENT=production

# 메트릭 (Prometheus)
PROMETHEUS_ENABLED=true
METRICS_PORT=9090
```

### Company A 토큰 시스템 연동 (현재 사용 안 함)
```bash
# CORPORATE_ENABLED=0
# CORPORATE_API_URL=
# CORPORATE_API_KEY=
# CORPORATE_CLIENT_ID=
# CORPORATE_CLIENT_SECRET=
CYBER_TOKEN_EXCHANGE_RATE=100
```

### SSL/보안 인증서
```bash
SSL_CERT_PATH=/etc/ssl/certs/yourdomain.crt
SSL_KEY_PATH=/etc/ssl/private/yourdomain.key
DOMAIN=yourdomain.com
```

### DNS 설정 (도메인 관리자 패널 입력 예시)
도메인을 `yourdomain.com`으로 가정하고, 단일 서버(리버스 프록시/Nginx) IP가 `203.0.113.10`인 경우 예시는 다음과 같습니다.

- A(IPv4)
	- 호스트: @ → 값: 203.0.113.10  (루트 도메인)
	- 호스트: api → 값: 203.0.113.10 (백엔드 API 서브도메인)
	- TTL: 300~600 권장
- AAAA(IPv6): 보유 시에만 입력 (없으면 비워둠)
- CNAME
	- 호스트: www → 값: yourdomain.com (www를 루트로 포워딩)
- MX: 이메일 서비스 사용 시에만 입력(미사용이면 비워둠)
- TXT(SPF): 이메일 발송 시에만 설정, 미사용이면 비워둠
- 웹포워딩/단일페이지: 사용하지 않음(웹서버에서 처리)

연동 환경변수(CORS/API 호출)는 다음과 같이 매칭합니다.
```bash
FRONTEND_URL=https://yourdomain.com
BACKEND_URL=https://api.yourdomain.com
```

### 초대코드 정책 (운영)
- 운영 정책: 단일/유일 초대코드로 `5858`만 허용
- 환경반영: 데이터 초기화/시드 시 `DEFAULT_INVITE_CODE=5858`로 유지
- 보안: 운영 전환 시에는 코드 회전 계획을 별도 수립(모니터링 룰과 함께)

---

## ✅ 우선순위 체크리스트

### 즉시 처리 (블로킹)
- [ ] JWT_SECRET_KEY 교체
- [ ] POSTGRES_PASSWORD 교체
- [ ] REDIS_PASSWORD 교체
- [ ] 도메인 URL 설정

### 단계적 처리 (운영 안정화)
- [ ] 결제 게이트웨이 연동
- [ ] 이메일/SMS 서비스 설정
- [ ] 모니터링 도구 연동
- [ ] SSL 인증서 적용
- [ ] Company A API 연동

---

## 📝 현재 서버에 저장된 실제 값들

### Docker Compose에서 사용 중인 값들:
```bash
# 현재 운영 중인 값들 (docker-compose.yml)
POSTGRES_USER: cc_user
POSTGRES_PASSWORD: cc_password           # ← 이것이 실제 DB 비밀번호
POSTGRES_DB: cc_webapp

REDIS_PASSWORD: redis_password           # ← 이것이 실제 Redis 비밀번호

JWT_SECRET_KEY: secret_key_for_development_only  # ← 개발용, 운영용으로 변경 필요

# 도메인/CORS 설정
CORS_ORIGINS: "http://localhost:3000,http://127.0.0.1:3000,https://localhost:3000,https://127.0.0.1:3000,http://localhost:40001,http://127.0.0.1:40001,http://frontend:3000"
```

### .env.production과 실제 서버 값 비교:
| 항목 | .env.production | docker-compose.yml 실제값 | 상태 |
|------|----------------|---------------------------|------|
| POSTGRES_PASSWORD | `secure_password_here` | `cc_password` | ❌ 불일치 |
| REDIS_PASSWORD | `change_this_for_prod` | `redis_password` | ❌ 불일치 |
| JWT_SECRET_KEY | `super_secure_production_key_here` | `secret_key_for_development_only` | ❌ 둘다 템플릿 |

### 📊 문제 진단:
1. **데이터 동기화 실패 원인**: .env.production의 템플릿 값들이 실제 서버 값과 다름
2. **JWT 토큰 문제**: 개발용 키 사용 중 → 프로덕션용으로 교체 필요
3. **환경 분리 필요**: 개발/운영 환경 설정값 정리 필요
