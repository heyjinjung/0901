# Casino-Club F2P 시드계정 관리 가이드

## 🏗️ 시드계정 구성 (seed_basic_accounts.py)

### 👨‍💼 관리자 계정 (1개)
```bash
site_id: admin
nickname: 어드민
password: 123456
phone_number: 01000000000
invite_code: 5858
is_admin: true
권한: 모든 관리자 기능 접근 가능
```

### 👥 일반 유저 계정 (4개)
```bash
# user001
site_id: user001
nickname: 유저01
password: 123455
phone_number: 01000000001
invite_code: 5858
is_admin: false

# user002
site_id: user002
nickname: 유저02
password: 123455
phone_number: 01000000002
invite_code: 5858
is_admin: false

# user003
site_id: user003
nickname: 유저03
password: 123455
phone_number: 01000000003
invite_code: 5858
is_admin: false

# user004
site_id: user004
nickname: 유저04
password: 123455
phone_number: 01000000004
invite_code: 5858
is_admin: false
```

---

## 🎮 시드 데이터 구성 (seed_and_explain.py)

### 📊 게임 세션 데이터 (5000건)
```bash
- 게임 타입: slot, gacha, crash
- 사용자 ID: 1-200 범위의 랜덤 사용자
- 베팅 금액: 10-5000 사이 랜덤
- 게임 라운드: 1-30 라운드
- 상태: active, ended, aborted
- 시간 범위: 최근 1주일 데이터
```

### 💰 상점 거래 데이터 (5000건)
```bash
- 상품 ID: prod-basic (기본 젬 상품)
- 구매 금액: 100-10000 사이 랜덤
- 거래 상태: success (성공)
- 구매자: 1-200 범위의 랜덤 사용자
- 시간 범위: 최근 2주일 데이터
```

---

## 🎯 이벤트/미션 시드 데이터 (seed_events_missions.py)

### 🎪 이벤트 데이터
```bash
# 신규 유저 환영 이벤트
- 제목: "신규 유저 환영 이벤트"
- 기간: 7일간
- 보상: 골드 5000, 젬 50
- 조건: 게임 10회 플레이

# 주말 보너스 이벤트
- 제목: "주말 보너스 이벤트"
- 기간: 2일간 (주말)
- 보상: 모든 게임 2배 보상
- 조건: 없음
```

### 🎯 미션 데이터
```bash
# 첫 게임 플레이 (일일 미션)
- 제목: "첫 게임 플레이"
- 목표: 아무 게임 1회 플레이
- 보상: 골드 100, 경험치 10
- 리셋 주기: 매일

# 슬롯 마스터 (주간 미션)
- 제목: "슬롯 마스터"
- 목표: 슬롯 게임 5회 플레이
- 보상: 골드 500, 경험치 50
- 리셋 주기: 매주
```

## 🚨 **중요: 기존 시드 데이터 문제점 발견!**

### ❌ **치명적 문제:**
```python
# 기존 seed_and_explain.py의 문제
uid = random.randint(1, 200)  # ← 존재하지 않는 유저 ID!

# 실제 시드계정들의 user_id
admin: user_id = 2
user001: user_id = 3  
user002: user_id = 4
user003: user_id = 5
user004: user_id = 6
```

**→ 기존 시드 데이터는 실제 시드계정과 전혀 무관한 가짜 데이터였음!**

### ✅ **해결책: seed_realistic_data.py**
- 실제 시드계정들의 user_id 사용
- 계정별 특성화된 활동 패턴
- 현실적인 시간/금액 분포

---

### 1. 기존 데이터 정리
```bash
# 논시드 사용자 삭제 (admin/seed/system 패턴 보존)
docker compose exec backend python -m scripts.user_sequence_health --purge-nonseed --dry-run
docker compose exec backend python -m scripts.user_sequence_health --purge-nonseed --confirm YES_PURGE
```

### 2. 기본 계정 재생성
```bash
# 기본 관리자/유저 계정 생성 (멱등)
docker compose exec backend python -m app.scripts.seed_basic_accounts
```

### 3. 게임 데이터 시드
```bash
# 게임 세션 및 상점 거래 데이터 생성
docker compose exec backend python seed_and_explain.py
```

### 4. 이벤트/미션 시드
```bash
# 이벤트 및 미션 데이터 생성
docker compose exec backend python -m scripts.seed_events_missions
```

---

## ⚙️ 자동 시드 설정

### AUTO_SEED_BASIC 환경변수
```bash
# docker-compose.yml 에서 설정
AUTO_SEED_BASIC: "1"  # 컨테이너 시작시 자동으로 기본 계정 생성
```

**동작 원리:**
- 컨테이너 시작시 admin 계정 존재 여부 확인
- 없으면 자동으로 seed_basic_accounts.py 실행
- 멱등성 보장 (이미 있으면 비밀번호만 재설정)

---

## 🔧 시드 관리 명령어

### 상태 확인
```bash
# 현재 시드 계정 확인
docker compose exec backend python -c "
from app.database import SessionLocal
from app.models.auth_models import User
db = SessionLocal()
users = db.query(User).filter(User.site_id.in_(['admin','user001','user002','user003','user004'])).all()
for u in users:
    print(f'{u.site_id}: {u.nickname} (admin={u.is_admin})')
db.close()
"
```

### 비밀번호 재설정
```bash
# 모든 시드 계정 비밀번호 재설정
docker compose exec backend python -m app.scripts.seed_basic_accounts
```

### 데이터베이스 정리
```bash
# 시드가 아닌 모든 사용자 삭제 (주의!)
docker compose exec backend python -m scripts.user_sequence_health --purge-nonseed --confirm YES_PURGE
```

---

## 📝 주의사항

### 🚨 중요
- **프로덕션에서는 기본 비밀번호 변경 필수**
- **admin 계정은 반드시 강력한 비밀번호로 변경**
- **invite_code '5858'은 테스트용, 운영시 변경 권장**

### ✅ 안전한 운영을 위한 체크리스트
- [ ] admin 계정 비밀번호 변경 완료
- [ ] 기본 시드 계정들 접근 제한 설정
- [ ] invite_code 시스템 정책 수립
- [ ] 정기적인 시드 데이터 정리 스케줄 설정
- [ ] 로그 모니터링으로 시드 계정 사용 추적
