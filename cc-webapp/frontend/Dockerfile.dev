FROM node:20-alpine

# Native deps compatibility (some packages expect glibc-like behavior)
RUN apk add --no-cache libc6-compat

WORKDIR /app



COPY . .

# Copy runtime start script
COPY .docker/start-dev.sh /usr/local/bin/start-dev
# Ensure Unix line endings to avoid Alpine sh "not found" on CRLF
RUN sed -i 's/\r$//' /usr/local/bin/start-dev && chmod +x /usr/local/bin/start-dev

# Default command uses robust start script
CMD ["/usr/local/bin/start-dev"]
